<!DOCTYPE html>
<html lang="vi">
<head>
    <!-- Thiết lập metadata và liên kết tài nguyên -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cổng thông tin học viên lập trình - Xứ Đoàn Các Thánh Tử Đạo Việt Nam - Giáo Xứ Chánh Tòa Mỹ Tho">
    <meta name="keywords" content="Xứ Đoàn, Giáo Xứ Chánh Tòa Mỹ Tho, Các Thánh Tử Đạo Việt Nam, học lập trình, cổng học viên">
    <title>Cổng Học Viên Lập Trình - Xứ Đoàn Các Thánh Tử Đạo Việt Nam</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Định nghĩa biến CSS để tái sử dụng màu sắc và phong cách */
        :root {
            --primary: #cc3048; /* Màu chính */
            --primary-dark: #b7142a; /* Màu chính tối hơn */
            --accent: #FFD700; /* Màu nhấn */
            --dark-bg: #1A1A1A; /* Màu nền tối */
            --text: #E0E0E0; /* Màu chữ */
            --error: #EF4444; /* Màu lỗi */
        }

        /* Thiết lập giao diện cơ bản cho body */
        body {
            background: linear-gradient(135deg, #2D2D2D 0%, #1A1A1A 100%);
            font-family: 'Roboto', sans-serif;
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: var(--text);
            overflow-x: hidden;
        }

        /* Tối ưu font cho iOS */
        body.ios {
            font-family: -apple-system, 'SF Pro', 'Roboto', sans-serif;
        }

        /* Popup thông báo quảng cáo */
        #thongbao-quangcao {
            position: fixed;
            bottom: 20px;
            right: 20px;
            max-width: 320px;
            background: #fff8e1;
            border: 1px solid #ffd54f;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 9999;
        }
        body.ios #thongbao-quangcao {
            /* Center popup on iOS and position above navbar */
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            max-width: 90%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            animation: slide-up 0.5s ease-out;
        }
        @keyframes slide-up {
            from { transform: translate(-50%, 100%); opacity: 0; }
            to { transform: translate(-50%, 0); opacity: 1; }
        }
        #thongbao-quangcao h4 {
            margin-top: 0;
            color: #d17b00;
            font-size: 16px;
        }
        body.ios #thongbao-quangcao h4 {
            color: var(--primary);
            font-size: 18px;
            text-align: center;
            font-weight: 600;
        }
        #thongbao-quangcao p {
            margin: 10px 0;
            color: #333;
            line-height: 1.4;
        }
        body.ios #thongbao-quangcao p {
            color: #1A1A1A;
            font-size: 14px;
            text-align: center;
        }
        #thongbao-quangcao img {
            display: block;
            max-width: 100%;
            margin: 10px 0;
        }
        body.ios #thongbao-quangcao img {
            max-width: 150px;
            margin: 15px auto;
            border-radius: 8px;
        }
        #thongbao-quangcao button {
            background: #ff9800;
            border: none;
            color: white;
            padding: 6px 10px;
            border-radius: 4px;
            cursor: pointer;
            float: right;
        }
        body.ios #thongbao-quangcao button {
            display: block;
            margin: 10px auto 0;
            padding: 10px Social20px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            background: var(--primary);
        }
        #thongbao-quangcao button:hover {
            background: #e68900;
        }
        body.ios #thongbao-quangcao button:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        /* Header chứa tiêu đề và mô tả trang */
        .header {
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--text);
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            position: sticky;
            top: 0;
            z-index: 1000;
            text-align: center;
        }
        body.ios .header {
            /* Use translucent header for iOS app-like feel */
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        .header h2 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        body.ios .header h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--accent);
        }
        .header p {
            font-size: 1rem;
            opacity: 0.9;
        }
        body.ios .header p {
            font-size: 0.85rem;
            color: var(--text);
        }

        /* Thanh điều hướng (navbar) */
        .navbar {
            background: var(--dark-bg);
            padding: 0.75rem;
            display: flex;
            justify-content: center;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
        }
        .navbar a {
            color: var(--text);
            padding: 0.75rem 1.5rem;
            margin: 0 0.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.2s ease;
            position: relative;
        }
        .navbar a:hover {
            background: var(--primary);
            color: var(--accent);
            transform: scale(1.05);
        }
        .navbar a.active {
            background: var(--primary);
            color: var(--accent);
        }

        /* Container chính chứa nội dung */
        .container {
            max-width: 1000px;
            margin: 2rem auto;
            padding: 0 1.5rem;
            flex: 1;
        }
        body.ios .container {
            /* Add padding to avoid overlap with fixed navbar on iOS */
            margin: 1rem auto;
            padding: 0 1rem;
            padding-bottom: 80px;
        }

        /* Card chứa các phần nội dung */
        .card {
            background: #252526;
            border: 1px solid #3C3C3C;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
            margin-bottom: 2rem;
        }
        body.ios .card {
            /* Use translucent cards for iOS with animation */
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: none;
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            max-width: 100%; /* Prevent cards from exceeding screen width */
            animation: slide-in 0.5s ease-out;
        }
        @keyframes slide-in {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card h3 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            color: var(--accent);
            margin-bottom: 1.5rem;
        }
        body.ios .card h3 {
            font-size: 1.3rem;
            text-align: center;
            font-weight: 600;
        }

        /* Bảng kết quả học tập */
        .table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 1rem;
        }
        /* Wrap table in a scrollable container for iOS */
        body.ios .table-container {
            overflow-x: auto;
            max-width: 100%;
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }
        .table th, .table td {
            padding: 1rem;
            border: 1px solid #3C3C3C;
            text-align: left;
            font-size: 0.95rem;
        }
        body.ios .table th, body.ios .table td {
            /* Reduce padding and font size for compact table on iOS */
            padding: 0.5rem;
            font-size: 0.8rem;
            border: none;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        .table th {
            background: var(--primary);
            color: var(--text);
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }
        body.ios .table th {
            background: rgba(204, 48, 72, 0.2);
            color: var(--accent);
        }
        .table td {
            background: #1E1E1E;
        }
        body.ios .table td {
            background: transparent;
            color: var(--text);
        }
        .table tr:hover td {
            background: #2A2A2A;
        }
        body.ios .table tr:hover td {
            background: rgba(255, 255, 255, 0.1);
        }
        /* Hide non-essential columns on iOS to reduce table width */
        body.ios .table th:nth-child(2), body.ios .table td:nth-child(2),
        body.ios .table th:nth-child(4), body.ios .table td:nth-child(4) {
            display: none;
        }

        /* Icon xếp hạng thành viên */
        .rank-icon {
            font-size: 1.2rem;
        }
        .rank-thanhvien { color: #B0B0B0; }
        .rank-vip { color: #FFD700; }
        .rank-silver { color: #C0C0C0; }
        .rank-gold { color: #FFD700; }
        .rank-diamond { color: #B9F2FF; }
        .rank-vvip { color: #FF69B4; }

        /* Lịch học */
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            background: #252526;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        body.ios .calendar {
            /* Optimize calendar for iOS with smaller cells and no background */
            background: transparent;
            padding: 0.5rem;
            gap: 3px;
            max-width: 100%; /* Ensure calendar fits screen width */
            grid-template-columns: repeat(7, minmax(0, 1fr)); /* Flexible columns */
        }
        .calendar div {
            padding: 0.75rem;
            text-align: center;
            border: 1px solid #3C3C3C;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
        }
        body.ios .calendar div {
            /* Smaller calendar cells for iOS */
            border: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 0.75rem;
            padding: 0.4rem;
        }
        .calendar .header {
            background: var(--primary);
            color: var(--text);
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }
        body.ios .calendar .header {
            background: rgba(204, 48, 72, 0.2);
            color: var(--accent);
            font-size: 0.8rem;
        }
        .calendar .has-event {
            background: var(--accent);
            color: #1A1A1A;
            font-weight: bold;
        }
        body.ios .calendar .has-event {
            background: var(--accent);
            transform: scale(1.05);
        }
        .calendar div:hover {
            background: #3C3C3C;
        }
        body.ios .calendar div:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Nút giao diện */
        .btn {
            background: var(--primary);
            color: var(--text);
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
            transition: all 0.2s ease;
            position: relative;
        }
        body.ios .btn {
            background: rgba(204, 48, 72, 0.9);
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
        }
        .btn:hover {
            background: var(--primary-dark);
            color: var(--accent);
            transform: translateY(-2px);
        }
        body.ios .btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }
        .btn:active {
            transform: translateY(0);
        }
        body.ios .btn:active {
            transform: scale(0.95);
            background: var(--accent);
            color: var(--dark-bg);
        }

        /* Input và textarea */
        .input, .textarea, select.input {
            background: #1E1E1E;
            border: 1px solid #3C3C3C;
            border-radius: 8px;
            padding: 0.75rem;
            color: var(--text);
            width: 100%;
            font-family: 'JetBrains Mono', monospace;
        }
        body.ios .input, body.ios .textarea, body.ios select.input {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 12px;
            padding: 0.85rem;
            color: var(--text);
            font-size: 1rem;
        }
        .textarea {
            resize: vertical;
            min-height: 150px;
            font-size: 0.9rem;
        }
        body.ios .textarea {
            min-height: 120px;
        }
        .file-input {
            background: #1E1E1E;
            border: 1px solid #3C3C3C;
            border-radius: 8px;
            padding: 0.75rem;
            color: var(--text);
            width: 100%;
            font-family: 'Roboto', sans-serif;
        }
        body.ios .file-input {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 12px;
        }

        /* Footer */
        .footer {
            background: var(--dark-bg);
            color: var(--text);
            padding: 2rem 1rem;
            text-align: center;
            box-shadow: 0 -2px 6px rgba(0, 0, 0, 0.3);
            margin-top: auto;
        }
        body.ios .footer {
            padding: 1rem;
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(10px);
        }
        .footer p {
            margin: 0.2rem 0;
        }
        body.ios .footer p {
            font-size: 0.85rem;
        }
        .highlight {
            color: var(--accent);
            font-weight: 700;
        }
        .contact {
            font-size: 10px;
            color: #D1D5DB;
        }

        /* Canvas cho game */
        #gameCanvas {
            display: block;
            margin: 0 auto;
            border: 2px solid var(--primary);
            border-radius: 8px;
            width: 400px;
            height: 200px;
        }
        body.ios #gameCanvas {
            /* Constrain canvas width to fit iOS screen */
            width: min(90vw, 360px);
            height: 180px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
        }

        /* Tùy chỉnh giao diện cho điện thoại và tablet */
        @media (max-width: 1024px) {
            :root {
                --primary: #e63950;
                --accent: #FFD54F;
            }
            #gameCanvas {
                width: 90vw;
                height: 150px;
            }
            .header h2 {
                font-size: 1.0rem;
            }
            .header p {
                font-size: 0.9rem;
            }
            .navbar {
                overflow-x: auto;
                white-space: nowrap;
            }
            .navbar a {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
                display: inline-flex;
                align-items: center;
                transition: transform 0.1s ease, background 0.1s ease;
            }
            .navbar a i {
                margin-right: 0.5rem;
            }
            .navbar a[href="#submit"] {
                display: none !important;
            }
            .navbar a[href="#game"] {
                display: inline-flex;
            }
            .card h3 {
                font-size: 1.3rem;
                font-weight: 600;
            }
            .table th, .table td {
                padding: 0.5rem;
                font-size: 0.85rem;
            }
            .calendar div {
                padding: 0.5rem;
                font-size: 0.85rem;
            }
            #thongbao-quangcao {
                max-width: 90%;
                bottom: 10px;
                right: 10px;
                font-size: 12px;
                animation: shake 0.5s ease-in-out;
            }
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                50% { transform: translateX(-5px); }
            }
            .btn:active, .navbar a:active {
                position: relative;
                overflow: hidden;
            }
            .btn:active::after, .navbar a:active::after {
                content: '';
                position: absolute;
                background: rgba(255, 255, 255, 0.3);
                width: 100px;
                height: 100px;
                border-radius: 50%;
                transform: scale(0);
                animation: ripple 0.3s linear;
            }
            @keyframes ripple {
                to {
                    transform: scale(4);
                    opacity: 0;
                }
            }
            #submit {
                display: none;
            }
            .btn:active {
                background: var(--accent);
                color: var(--dark-bg);
                transform: scale(0.98);
            }
            .footer p {
                font-size: 10px;
            }
            .footer .contact {
                font-size: 10px;
            }
            body.ios {
                font-family: -apple-system, 'SF Pro', 'Roboto', sans-serif;
            }
            body.ios :root {
                --primary: #cc3048;
                --accent: #FFD700;
            }
            body.ios .header h2, body.ios .card h3 {
                font-weight: 500;
            }
            body.ios .navbar {
                /* Fixed bottom navbar for iOS with icon-focused design */
                position: fixed;
                bottom: 0;
                width: 100%;
                display: flex;
                justify-content: space-around;
                background: rgba(26, 26, 26, 0.95);
                backdrop-filter: blur(10px);
                box-shadow: 0 -2px 6px rgba(0, 0, 0, 0.3);
                padding: 0.5rem 0;
                z-index: 1000;
            }
            body.ios .navbar a {
                flex: 1;
                text-align: center;
                padding: 0.5rem;
                font-size: 0.75rem;
                display: flex;
                flex-direction: column;
                align-items: center;
                transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
                border-radius: 12px;
                margin: 0 4px;
            }
            body.ios .navbar a i {
                font-size: 1.5rem;
                margin-bottom: 0.3rem;
            }
            body.ios .navbar a.active {
                background: rgba(204, 48, 72, 0.2);
                color: var(--accent);
                transform: scale(1.1);
                box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            }
            body.ios .navbar a:hover {
                background: rgba(204, 48, 72, 0.3);
                transform: scale(1.1);
            }
            body.ios .navbar a:active {
                transform: scale(0.95);
                box-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
                background: rgba(204, 48, 72, 0.4);
            }
            body.ios #eventDetails {
                /* Position event details above navbar on iOS */
                position: fixed;
                bottom: 80px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(26, 26, 26, 0.95);
                backdrop-filter: blur(10px);
                padding: 1rem;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                max-width: 90%;
                font-size: 0.9rem;
                animation: slide-up 0.3s ease-out;
            }
            body.ios #game .mt-4 {
                font-size: 0.9rem;
                padding: 0.5rem;
            }
            body.ios #game .btn {
                padding: 0.75rem 1.5rem;
                font-size: 1rem;
            }
        }

        /* Tùy chỉnh cho máy tính bảng */
        @media (min-width: 641px) and (max-width: 1024px) {
            .header h2 {
                font-size: 1.75rem;
            }
            .navbar a {
                padding: 0.6rem 1.2rem;
                font-size: 1rem;
            }
            .card h3 {
                font-size: 1.4rem;
            }
            .table th, .table td {
                padding: 0.75rem;
                font-size: 0.9rem;
            }
            .calendar div {
                padding: 0.6rem;
                font-size: 0.9rem;
            }
            .btn:active {
                box-shadow: 0 0 8px var(--accent);
                transform: scale(0.98);
            }
        }

        /* Tùy chỉnh cho laptop */
        @media (min-width: 1025px) {
            .navbar a:hover {
                background: linear-gradient(45deg, var(--primary), var(--accent));
            }
            .tooltip {
                position: absolute;
                background: var(--dark-bg);
                color: var(--text);
                padding: 0.3rem 0.6rem;
                border-radius: 4px;
                font-size: 0.8rem;
                top: 100%;
                display: none;
                z-index: 10;
            }
            label:hover .tooltip {
                display: block;
            }
            .textarea {
                min-height: 300px;
                font-size: 1rem;
            }
            .navbar a[href="#game"] {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Popup thông báo thư ngỏ và mã QR -->
    <div id="thongbao-quangcao">
        <h4>THƯ NGỎ</h4>
        <p>
            Chào quý thành viên,<br>
            Chúng chúng tôi là Ban Truyền Thông & Ban Kỹ Thuật của trang web Xứ Đoàn Các Thánh Tử Đạo Việt Nam - Giáo Xứ Chánh Tòa Mỹ Tho.<br><br>
            Đây là trang phi lợi nhuận nhằm kết nối truyền thông với thời đại mới. Các khóa học miễn phí được tổ chức nhằm giúp phát triển kỹ năng và kiến thức, tất cả do quý Trưởng phân công hướng dẫn.<br><br>
            Mong nhận được sự đóng góp và ủng hộ để duy trì hệ thống hoạt động.<br><br>
            <strong>Mã QR hỗ trợ ở bên dưới:</strong>
        </p>
        <img id="qrCode" src="Qr_Code.jpg" alt="Mã QR hỗ trợ">
        <button onclick="document.getElementById('thongbao-quangcao').style.display='none'">Đóng</button>
    </div>

    <!-- Header với tiêu đề và mô tả -->
    <div class="header">
        <h2>XỨ ĐOÀN CÁC THÁNH TỬ ĐẠO VIỆT NAM</h2>
        <p>Cổng Học Viên Lập Trình - Giáo Xứ Chánh Tòa Mỹ Tho</p>
    </div>

    <!-- Thanh điều hướng với các mục -->
    <div class="navbar">
        <a href="#home" class="active"><i class="fas fa-home"></i> Trang Chủ</a>
        <a href="#calendar"><i class="fas fa-calendar"></i> Lịch Học</a>
        <a href="#submit"><i class="fas fa-upload"></i> Nộp Bài</a>
        <a href="#game" class="hidden"><i class="fas fa-gamepad"></i> Giải Trí</a>
        <a href="#feedback"><i class="fas fa-comment"></i> Phản Hồi</a>
    </div>

    <!-- Container chứa các section nội dung -->
    <div class="container">
        <!-- Section Trang Chủ: Hiển thị kết quả học tập -->
        <div id="home" class="card">
            <h3>Kết Quả Học Tập Khoá</h3>
            <!-- Wrap table in a div for scrollable container on iOS -->
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Tên</th>
                            <th>Hạng Thành Viên</th>
                            <th>Môn</th>
                            <th>Thời Lượng</th>
                            <th>Đã Hoàn Tất (%)</th>
                            <th>Điểm</th>
                        </tr>
                    </thead>
                    <tbody id="subjectsTable"></tbody>
                </table>
            </div>
        </div>

        <!-- Section Lịch Học: Hiển thị lịch học theo tháng -->
        <div id="calendar" class="card hidden">
            <h3>Lịch Học</h3>
            <div class="flex justify-between mb-4">
                <button class="btn" onclick="prevMonth()">◄</button>
                <h4 id="monthYear" class="font-bold text-accent"></h4>
                <button class="btn" onclick="nextMonth()">►</button>
            </div>
            <div class="calendar" id="calendarGrid"></div>
            <div id="eventDetails" class="mt-4 text-text"></div>
        </div>

        <!-- Section Nộp Bài: Form nộp bài tập -->
        <div id="submit" class="card hidden">
            <h3>Nộp Bài</h3>
            <form id="codeForm" action="https://formsubmit.co/notification2411.huynhdutruong@gmail.com" method="POST" enctype="multipart/form-data">
                <div class="mb-4">
                    <label class="block mb-1 text-text relative">Họ và Tên: <span class="tooltip">Nhập tên đầy đủ hoặc tên Thánh</span></label>
                    <input type="text" name="fullName" id="codeFullName" class="input" required>
                </div>
                <div class="mb-4">
                    <label class="block mb-1 text-text relative">Ngôn Ngữ: <span class="tooltip">Chọn ngôn ngữ lập trình hoặc loại bài nộp</span></label>
                    <select name="language" class="input" required>
                        <option value="python">Python</option>
                        <option value="javascript">JavaScript</option>
                        <option value="html_css">HTML/CSS</option>
                        <option value="other">Khác (báo cáo, file)</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block mb-1 text-text relative">Mã Nguồn: <span class="tooltip">Dán mã nguồn (nếu có)</span></label>
                    <textarea name="codeContent" class="textarea" placeholder="Dán mã nguồn của bạn (nếu có)..."></textarea>
                </div>
                <div class="mb-4">
                    <label class="block mb-1 text-text relative">Link Bài Nộp: <span class="tooltip">Dán URL (Google Drive, GitHub, v.v.) nếu không dán code</span></label>
                    <input type="url" name="submissionLink" class="input" placeholder="https://...">
                </div>
                <div class="mb-4">
                    <label class="block mb-1 text-text relative">File Báo Cáo: <span class="tooltip">Tải lên file (<100MB, PDF, ZIP, TXT, v.v.)</span></label>
                    <input type="file" name="submissionFile" id="submissionFile" class="file-input" accept=".pdf,.zip,.txt,.doc,.docx">
                </div>
                <input type="hidden" name="submissionTime" id="submissionTime">
                <button type="submit" class="btn">Gửi Bài</button>
            </form>
        </div>

        <!-- Section Giải Trí: Chứa game T-Rex (iOS) hoặc Blast Block (Android) -->
        <div id="game" class="card hidden">
            <h3 id="gameTitle">Game</h3>
            <canvas id="gameCanvas"></canvas>
            <div class="mt-4 text-center">
                <p id="gameInstructions"></p>
                <p id="scoreDisplay">Điểm: 0</p>
                <button class="btn" onclick="startGame()">Bắt Đầu Lại</button>
            </div>
        </div>

        <!-- Section Phản Hồi: Form gửi ý kiến -->
        <div id="feedback" class="card hidden">
            <h3>Phản Hồi</h3>
            <form id="feedbackForm" action="https://formsubmit.co/notification2411.huynhdutruong@gmail.com" method="POST">
                <div class="mb-4">
                    <label class="block mb-1 text-text relative">Họ và Tên: <span class="tooltip">Nhập tên đầy đủ hoặc tên Thánh</span></label>
                    <input type="text" name="fullName" id="feedbackFullName" class="input" required>
                </div>
                <div class="mb-4">
                    <label class="block mb-1 text-text relative">Gmail: <span class="tooltip">Nhập email để nhận phản hồi</span></label>
                    <input type="email" name="gmail" class="input" required>
                </div>
                <div class="mb-4">
                    <label class="block mb-1 text-text relative">Nội Dung (Tối đa 250 chữ): <span class="tooltip">Mô tả ý kiến của bạn</span></label>
                    <textarea name="content" class="textarea" maxlength="250" required></textarea>
                </div>
                <input type="hidden" name="submissionTime" id="feedbackSubmissionTime">
                <button type="submit" class="btn">Gửi Phản Hồi</button>
            </form>
        </div>
    </div>

    <!-- Footer chứa thông tin bản quyền và liên hệ -->
    <div class="footer">
        <p class="highlight">Bản quyền © 2025 - Xứ Đoàn Các Thánh Tử Đạo Việt Nam</p>
        <p>Giáo Xứ Chánh Tòa Mỹ Tho - Giáo Phận Mỹ Tho - Việt Nam</p>
        <p class="contact">Địa chỉ: 32 Hùng Vương, Phường 7, Thành phố Mỹ Tho, Tiền Giang</p>
    </div>

    <script>
        // Phát hiện thiết bị iOS hoặc Android
        const isIOS = navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad');
        const isAndroid = navigator.userAgent.includes('Android');
        if (isIOS) {
            document.body.classList.add('ios');
            document.getElementById('qrCode').src = 'Qr_Code.jpg';
            document.getElementById('gameTitle').textContent = 'Khủng Long Vượt Chướng Ngại Vật';
            document.getElementById('gameInstructions').innerHTML = 'Chạm màn hình để nhảy. Tránh các chướng ngại vật!';
        } else if (isAndroid) {
            document.body.classList.add('android');
            document.getElementById('qrCode').src = 'Qr_Code.webp';
            document.getElementById('gameTitle').textContent = 'Blast Block';
            document.getElementById('gameInstructions').innerHTML = 'Chạm vào các khối để phá chúng. Phá càng nhiều khối càng tốt!';
        }

        // Điều chỉnh kích thước canvas cho game
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        function resizeCanvas() {
            if (window.innerWidth <= 1024) {
                // Constrain canvas width to fit mobile screen, max 360px for iOS
                canvas.width = isIOS ? Math.min(window.innerWidth * 0.9, 360) : window.innerWidth * 0.9;
                canvas.height = isIOS ? 180 : 150;
            } else {
                canvas.width = 600;
                canvas.height = 200;
            }
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // Ẩn liên kết Nộp Bài trên điện thoại và tablet khi tải trang
        window.addEventListener('load', () => {
            if (window.innerWidth <= 1024) {
                document.querySelector('.navbar a[href="#submit"]').style.display = 'none';
            }
        });

        // Ẩn liên kết Nộp Bài khi thay đổi kích thước màn hình
        window.addEventListener('resize', () => {
            if (window.innerWidth <= 1024) {
                document.querySelector('.navbar a[href="#submit"]').style.display = 'none';
            } else {
                document.querySelector('.navbar a[href="#submit"]').style.display = 'inline-flex';
            }
        });

        // Tải dữ liệu thành viên từ users.json
        async function loadUsersData() {
            try {
                const response = await fetch('data/users.json');
                if (!response.ok) throw new Error('Failed to load users.json');
                const users = await response.json();
                populateSubjectsTable(users);
            } catch (error) {
                console.error('Error loading users data:', error);
                document.getElementById('subjectsTable').innerHTML = '<tr><td colspan="6">Không thể tải dữ liệu thành viên.</td></tr>';
            }
        }

        // Tải dữ liệu lịch học từ calendar.json
        async function loadCalendarData() {
            try {
                const response = await fetch('data/calendar.json');
                if (!response.ok) throw new Error('Failed to load calendar.json');
                const calendarData = await response.json();
                renderCalendar(calendarData);
            } catch (error) {
                console.error('Error loading calendar data:', error);
                document.getElementById('calendarGrid').innerHTML = '<div class="col-span-7 text-center">Không thể tải lịch học.</div>';
            }
        }

        // Tính toán xếp hạng thành viên dựa trên tổng điểm
        function getMembershipRank(totalScore) {
            if (totalScore < 50) return '<i class="fas fa-user rank-icon rank-thanhvien"></i>';
            if (totalScore < 100) return '<i class="fas fa-star rank-icon rank-vip"></i>';
            if (totalScore < 201) return '<i class="fas fa-medal rank-icon rank-silver"></i>';
            if (totalScore < 301) return '<i class="fas fa-medal rank-icon rank-gold"></i>';
            if (totalScore < 501) return '<i class="fas fa-gem rank-icon rank-diamond"></i>';
            return '<i class="fas fa-crown rank-icon rank-vvip"></i>';
        }

        // Hiển thị bảng kết quả học tập
        function populateSubjectsTable(users) {
            const subjectsTable = document.getElementById('subjectsTable');
            subjectsTable.innerHTML = '';
            users.members.forEach(member => {
                const totalScore = member.subjects.reduce((sum, subject) => sum + subject.score, 0);
                const rank = getMembershipRank(totalScore);
                member.subjects.forEach(subject => {
                    const row = document.createElement('tr');
                    // Include all columns, but CSS hides non-essential ones on iOS
                    row.innerHTML = `
                        <td>${member.fullName}</td>
                        <td>${rank}</td>
                        <td>${subject.name}</td>
                        <td>${subject.duration}</td>
                        <td>${subject.completion}%</td>
                        <td>${subject.score}</td>
                    `;
                    subjectsTable.appendChild(row);
                });
            });
        }

        // Hiển thị lịch học theo tháng
        let currentDate = new Date();
        function renderCalendar(calendarData) {
            const calendarGrid = document.getElementById('calendarGrid');
            const monthYear = document.getElementById('monthYear');
            calendarGrid.innerHTML = '';

            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            monthYear.textContent = `${month + 1}-${year}`;

            const days = ['CN', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7'];
            days.forEach(day => {
                const div = document.createElement('div');
                div.textContent = day;
                div.classList.add('header');
                calendarGrid.appendChild(div);
            });

            const firstDay = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();

            for (let i = 0; i < firstDay; i++) {
                calendarGrid.appendChild(document.createElement('div'));
            }

            for (let date = 1; date <= lastDate; date++) {
                const div = document.createElement('div');
                div.textContent = date;
                const event = calendarData.find(e => {
                    const eventDate = new Date(e.date);
                    return eventDate.getDate() === date && eventDate.getMonth() === month && eventDate.getFullYear() === year;
                });
                if (event) {
                    div.classList.add('has-event');
                    div.addEventListener('click', () => {
                        document.getElementById('eventDetails').innerHTML = `
                            <p><strong>Môn:</strong> ${event.subject}</p>
                            <p><strong>Thời gian:</strong> Từ ${event.startTime} đến ${event.endTime}</p>
                            <p><strong>Buổi:</strong> ${event.session}</p>
                        `;
                    });
                    if (isAndroid) {
                        div.addEventListener('touchstart', function(e) {
                            setTimeout(() => {
                                if (div.classList.contains('has-event')) {
                                    div.click();
                                }
                            }, 500);
                        });
                    } else if (isIOS) {
                        div.addEventListener('touchstart', function(e) {
                            e.preventDefault();
                            div.click();
                        });
                    }
                }
                calendarGrid.appendChild(div);
            }
        }

        // Chuyển tháng trước
        function prevMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            loadCalendarData();
        }

        // Chuyển tháng sau
        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            loadCalendarData();
        }

        // Xử lý gửi form nộp bài
        document.getElementById('codeForm').addEventListener('submit', (e) => {
            const fileInput = document.getElementById('submissionFile');
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0);
                if (file.size > 100 * 1024 * 1024) {
                    e.preventDefault();
                    alert('File quá lớn! Vui lòng chọn file dưới 100MB.');
                    return;
                }
            }
            document.getElementById('submissionTime').value = new Date().toLocaleString('vi-VN');
        });

        // Xử lý gửi form phản hồi
        document.getElementById('feedbackForm').addEventListener('submit', () => {
            document.getElementById('feedbackSubmissionTime').value = new Date().toLocaleString('vi-VN');
        });

        // Logic game
        let gameRunning = false;
        let score = 0;
        let frameCount = 0;

        if (isIOS) {
            // Game T-Rex cho iOS
            let dino = { x: 50, y: 120, width: 40, height: 40, dy: 0, gravity: 0.8, jumpPower: -12, grounded: true };
            let obstacles = [];

            function drawDino() {
                // Draw circular dino for a modern iOS look
                ctx.fillStyle = 'white';
                ctx.beginPath();
                ctx.arc(dino.x + dino.width / 2, dino.y + dino.height / 2, dino.width / 2, 0, Math.PI * 2);
                ctx.fill();
            }

            function drawObstacles() {
                ctx.fillStyle = 'green';
                obstacles.forEach(obstacle => {
                    ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
                });
            }

            function spawnObstacle() {
                // Adjust obstacle size for smaller canvas on iOS
                const obstacle = { x: canvas.width, y: 140, width: 15, height: 30, speed: 5 };
                obstacles.push(obstacle);
            }

            function updateGame() {
                if (!gameRunning) return;

                ctx.clearRect(0, 0, canvas.width, canvas.height);

                dino.dy += dino.gravity;
                dino.y += dino.dy;
                if (dino.y > 140) {
                    dino.y = 140;
                    dino.dy = 0;
                    dino.grounded = true;
                }
                drawDino();

                if (frameCount % 50 === 0) {
                    spawnObstacle();
                }
                obstacles.forEach(obstacle => {
                    obstacle.x -= obstacle.speed;
                });
                obstacles = obstacles.filter(obstacle => obstacle.x + obstacle.width > 0);
                drawObstacles();

                for (let obstacle of obstacles) {
                    if (
                        dino.x < obstacle.x + obstacle.width &&
                        dino.x + dino.width > obstacle.x &&
                        dino.y < obstacle.y + obstacle.height &&
                        dino.y + dino.height > obstacle.y
                    ) {
                        gameRunning = false;
                        alert(`Game Over! Điểm: ${score}`);
                        return;
                    }
                }

                score = Math.floor(frameCount / 10);
                document.getElementById('scoreDisplay').textContent = `Điểm: ${score}`;
                frameCount++;

                requestAnimationFrame(updateGame);
            }

            function startGame() {
                gameRunning = true;
                score = 0;
                frameCount = 0;
                dino.y = 140;
                dino.dy = 0;
                dino.grounded = true;
                obstacles = [];
                document.getElementById('scoreDisplay').textContent = `Điểm: ${score}`;
                updateGame();
            }

            document.addEventListener('touchstart', (e) => {
                if (e.target === canvas && dino.grounded && gameRunning) {
                    dino.dy = dino.jumpPower;
                    dino.grounded = false;
                }
            });
        } else if (isAndroid) {
            // Game Blast Block cho Android (unchanged)
            let blocks = [];
            const blockSize = 30;
            const rows = Math.floor(canvas.height / blockSize);
            const cols = Math.floor(canvas.width / blockSize);

            function createBlocks() {
                blocks = [];
                for (let row = 0; row < rows; row++) {
                    for (let col = 0; col < cols; col++) {
                        if (Math.random() > 0.3) {
                            blocks.push({
                                x: col * blockSize,
                                y: row * blockSize,
                                width: blockSize,
                                height: blockSize,
                                color: `hsl(${Math.random() * 360}, 70%, 50%)`
                            });
                        }
                    }
                }
            }

            function drawBlocks() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                blocks.forEach(block => {
                    ctx.fillStyle = block.color;
                    ctx.fillRect(block.x, block.y, block.width - 2, block.height - 2);
                });
            }

            function updateGame() {
                if (!gameRunning) return;

                drawBlocks();

                document.getElementById('scoreDisplay').textContent = `Điểm: ${score}`;
                frameCount++;

                requestAnimationFrame(updateGame);
            }

            function startGame() {
                gameRunning = true;
                score = 0;
                frameCount = 0;
                createBlocks();
                document.getElementById('scoreDisplay').textContent = `Điểm: ${score}`;
                updateGame();
            }

            canvas.addEventListener('touchstart', (e) => {
                if (!gameRunning) return;
                const rect = canvas.getBoundingClientRect();
                const touchX = e.touches[0].clientX - rect.left;
                const touchY = e.touches[0].clientY - rect.top;

                blocks = blocks.filter(block => {
                    if (
                        touchX >= block.x &&
                        touchX <= block.x + block.width &&
                        touchY >= block.y &&
                        touchY <= block.y + block.height
                    ) {
                        score += 10;
                        return false;
                    }
                    return true;
                });

                if (blocks.length === 0) {
                    gameRunning = false;
                    alert(`Chúc mừng! Bạn đã phá hết khối! Điểm: ${score}`);
                }
            });

            document.addEventListener('click', (e) => {
                if (!gameRunning) return;
                const rect = canvas.getBoundingClientRect();
                const clickX = e.clientX - rect.left;
                const clickY = e.clientY - rect.top;

                blocks = blocks.filter(block => {
                    if (
                        clickX >= block.x &&
                        clickX <= block.x + block.width &&
                        clickY >= block.y &&
                        clickY <= block.y + block.height
                    ) {
                        score += 10;
                        return false;
                    }
                    return true;
                });

                if (blocks.length === 0) {
                    gameRunning = false;
                    alert(`Chúc mừng! Bạn đã phá hết khối! Điểm: ${score}`);
                }
            });
        }

        // Điều hướng giữa các section
        const sections = ['home', 'calendar', 'submit', 'game', 'feedback'];
        function showSection(sectionId) {
            sections.forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(sectionId).classList.remove('hidden');
            document.querySelectorAll('.navbar a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').substring(1) === sectionId) {
                    link.classList.add('active');
                }
            });
        }

        // Xử lý sự kiện click trên navbar
        document.querySelectorAll('.navbar a').forEach(link => {
            link.addEventListener('click', e => {
                e.preventDefault();
                const sectionId = link.getAttribute('href').substring(1);
                showSection(sectionId);
            });
            if (isIOS) {
                link.addEventListener('touchstart', e => {
                    e.preventDefault();
                    const sectionId = link.getAttribute('href').substring(1);
                    showSection(sectionId);
                });
            }
        });

        // Khởi tạo trang
        document.addEventListener('DOMContentLoaded', () => {
            loadUsersData();
            loadCalendarData();
            showSection('home');
        });
    </script>
</body>
</html>
