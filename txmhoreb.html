<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bài đánh giá</title>
  <style>
    body {
      background: url('https://www.transparenttextures.com/patterns/old-wall.png');
      background-color: #f4e4bc;
      font-family: 'Cinzel', serif;
      color: #2c1b07;
      margin: 0;
      padding: 1.5rem;
      min-height: 100vh;
      box-sizing: border-box;
      position: relative;
    }
    .container {
      background: url('https://www.transparenttextures.com/patterns/paper-fibers.png');
      background-color: #fdf5e6;
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3), inset 0 0 10px rgba(0, 0, 0, 0.1);
      max-width: 900px;
      margin: 0 auto;
      border: 3px solid #8b5a2b;
      width: 100%;
      box-sizing: border-box;
      position: relative;
      z-index: 1;
    }
    h1 {
      font-size: 2rem;
      color: #8b5a2b;
      text-align: center;
      margin-bottom: 1.5rem;
      font-weight: normal;
      text-transform: uppercase;
      letter-spacing: 3px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
    }
    .form-container input,
    .form-container select,
    .form-container textarea {
      width: 100%;
      padding: 0.6rem;
      margin: 0.5rem 0;
      border: 1px solid #8b5a2b;
      border-radius: 5px;
      font-family: 'Cinzel', serif;
      font-size: 1rem;
      background-color: #fffaf0;
      box-sizing: border-box;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    .form-container .date-select {
      display: flex;
      gap: 0.5rem;
    }
    .form-container .date-select select {
      flex: 1;
    }
    .form-container textarea {
      min-height: 100px;
      resize: vertical;
    }
    .form-container button {
      background-color: #8b5a2b;
      color: #fff;
      padding: 0.6rem 1.2rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      font-size: 1rem;
      display: block;
      margin: 1.5rem auto;
      transition: background-color 0.3s;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }
    .form-container button:hover {
      background-color: #6b4226;
    }
    .question {
      margin: 1.5rem 0;
    }
    .question p {
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
      color: #2c1b07;
    }
    #timer {
      position: fixed;
      top: 1rem;
      right: 1rem;
      background: url('https://www.transparenttextures.com/patterns/parchment.png');
      background-color: #f4e4bc;
      padding: 0.5rem 1rem;
      border: 2px solid #8b5a2b;
      border-radius: 5px;
      font-family: 'Cinzel', serif;
      font-size: 1.2rem;
      color: #2c1b07;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      z-index: 1000;
    }
    #warning {
      display: none;
      position: fixed;
      top: 4rem;
      right: 1rem;
      background-color: #8b0000;
      color: #fff;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      font-family: 'Cinzel', serif;
      font-size: 1rem;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      z-index: 1000;
    }
    .modal {
      display: flex;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }
    .modal-content {
      background: url('https://www.transparenttextures.com/patterns/paper-fibers.png');
      background-color: #fdf5e6;
      padding: 2rem;
      border-radius: 10px;
      border: 3px solid #8b5a2b;
      max-width: 600px;
      width: 90%;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      font-family: 'Cinzel', serif;
      color: #2c1b07;
    }
    .modal-content h2 {
      font-size: 1.5rem;
      color: #8b5a2b;
      text-align: center;
      margin-bottom: 1rem;
    }
    .modal-content ol {
      margin: 1rem 0;
      padding-left: 1.5rem;
    }
    .modal-content button {
      background-color: #8b5a2b;
      color: #fff;
      padding: 0.6rem 1.2rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      font-size: 1rem;
      display: block;
      margin: 1rem auto;
    }
    .modal-content button:hover {
      background-color: #6b4226;
    }
    #accessMessage {
      display: none;
      text-align: center;
      font-size: 1.2rem;
      color: #8b0000;
      margin-top: 1rem;
    }
    @media (max-width: 600px) {
      body {
        padding: 1rem;
      }
      .container {
        padding: 1rem;
      }
      h1 {
        font-size: 1.5rem;
        letter-spacing: 2px;
      }
      .question p {
        font-size: 0.95rem;
      }
      .form-container input,
      .form-container select,
      .form-container textarea,
      .form-container button {
        font-size: 0.9rem;
        padding: 0.5rem;
      }
      .form-container .date-select select {
        font-size: 0.9rem;
      }
      #timer {
        font-size: 1rem;
        padding: 0.4rem 0.8rem;
        top: 0.5rem;
        right: 0.5rem;
      }
      #warning {
        font-size: 0.9rem;
        padding: 0.4rem 0.8rem;
        top: 3rem;
        right: 0.5rem;
      }
      .modal-content {
        padding: 1rem;
        width: 95%;
      }
      .modal-content h2 {
        font-size: 1.2rem;
      }
      .modal-content ol {
        font-size: 0.9rem;
      }
      .modal-content button {
        font-size: 0.9rem;
        padding: 0.5rem 1rem;
      }
      #accessMessage {
        font-size: 1rem;
      }
    }
    @media (min-width: 601px) and (max-width: 1024px) {
      body {
        padding: 1.5rem;
      }
      .container {
        padding: 1.5rem;
        max-width: 700px;
      }
      h1 {
        font-size: 1.8rem;
        letter-spacing: 2.5px;
      }
      .question p {
        font-size: 1rem;
      }
      .form-container input,
      .form-container select,
      .form-container textarea {
        font-size: 0.95rem;
        padding: 0.55rem;
      }
      .form-container button {
        font-size: 0.95rem;
        padding: 0.55rem 1.1rem;
      }
      #timer {
        font-size: 1.1rem;
        padding: 0.5rem 0.9rem;
      }
      #warning {
        font-size: 0.95rem;
        padding: 0.5rem 0.9rem;
      }
      .modal-content {
        padding: 1.5rem;
        width: 80%;
      }
      .modal-content h2 {
        font-size: 1.4rem;
      }
      .modal-content ol {
        font-size: 1rem;
      }
      #accessMessage {
        font-size: 1.1rem;
      }
    }
    @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap');
  </style>
</head>
<body>
  <div id="timer" style="display: none;">Thời gian còn lại: 15:00</div>
  <div id="warning" style="display: none;">Cảnh báo: Còn 5 phút nữa sẽ hết giờ!</div>
  <div id="rulesModal" class="modal" style="display: none;">
    <div class="modal-content">
      <h2>Nội quy làm bài</h2>
      <ol>
        <li>Bài sẽ có thời gian 15 phút để thực hiện, sau thời gian quy định sẽ tự động nộp.</li>
        <li>Vui lòng điền đủ thông tin các trường.</li>
        <li>Cấm hành vi gian lận (copy/paste, chuyển màn hình). Nếu vi phạm, bài làm sẽ tự nộp và chấm theo đáp án đã hoàn tất trước đó.</li>
        <li>Sau khi nhấn nộp bài, vui lòng kiểm tra và hoàn tất yêu cầu kiểm tra trí tuệ nhân tạo cho đến khi hiển thị "Thanks", tức bài nộp đã được gửi.</li>
      </ol>
      <button id="startExam" style="display: none;">Bắt đầu làm bài</button>
      <div id="accessMessage"></div>
    </div>
  </div>
  <div class="container" style="display: none;">
    <h1>BÀI ĐÁNH GIÁ</h1>
    <form id="feedbackForm" action="https://formsubmit.co/notification2411.huynhdutruong@gmail.com" method="POST" enctype="multipart/form-data" class="form-container">
      <input type="text" id="fullName" name="fullName" placeholder="Họ và tên" required>
      <div class="date-select">
        <select id="dobDay" name="dobDay" required>
          <option value="" disabled selected>Ngày</option>
        </select>
        <select id="dobMonth" name="dobMonth" required>
          <option value="" disabled selected>Tháng</option>
        </select>
        <select id="dobYear" name="dobYear" required>
          <option value="" disabled selected>Năm</option>
        </select>
      </div>
      <input type="email" id="gmail" name="gmail" placeholder="Gmail" required>
      <input type="tel" id="phone" name="phone" placeholder="Số điện thoại" required>
      <input type="hidden" id="submissionTime" name="submissionTime">
      <input type="hidden" id="userAgent" name="userAgent">
      
      <div id="questions">
        <!-- Câu hỏi và textarea sẽ được thêm bằng JavaScript -->
      </div>
      <button type="submit">Nộp bài</button>
    </form>
  </div>

  <script>
    // Danh sách câu hỏi từ test.csv và các bài hát
    const allQuestions = [
      { id: 1, text: "Phong trào Nghĩa Binh Thánh Thể đến Việt Nam vào năm nào?" },
      { id: 2, text: "Phong trào Nghĩa Binh Thánh Thể được thành lập vào năm nào?" },
      { id: 3, text: "Nghĩa Binh Thánh Thể tại Sài Gòn được thành lập vào năm nào?" },
      { id: 4, text: "Vị Tổng Tuyên úy đầu tiên của Phong trào Nghĩa Binh Thánh Thể Việt Nam là ai?" },
      { id: 5, text: "Nghĩa Binh Thánh Thể được đổi tên thành Phong trào Thiếu Nhi Thánh Thể vào năm nào?" },
      { id: 6, text: "Cha Tuyên úy hiện tại của Liên đoàn Các Thánh Tử Đạo Việt Nam (Giáo phận Mỹ Tho) là ai?" },
      { id: 7, text: "Cha Phó Tuyên úy của Liên đoàn Các Thánh Tử Đạo Việt Nam (Giáo phận Mỹ Tho) là ai?" },
      { id: 8, text: "Cha Tổng Tuyên úy hiện tại của Thiếu Nhi Thánh Thể Việt Nam là ai?" },
      { id: 9, text: "Hãy viết bốn khẩu hiệu của Phong trào Thiếu Nhi Thánh Thể." },
      { id: 10, text: "Hãy viết điều luật 1 và 2 trong 10 điều luật của Thiếu Nhi Thánh Thể." },
      { id: 11, text: "Hãy viết điều luật 3 và 4 trong 10 điều luật của Thiếu Nhi Thánh Thể." },
      { id: 12, text: "Hãy viết điều luật 5 và 6 trong 10 điều luật của Thiếu Nhi Thánh Thể." },
      { id: 13, text: "Hãy viết điều luật 7 và 8 trong 10 điều luật của Thiếu Nhi Thánh Thể." },
      { id: 14, text: "Hãy viết điều luật 9 và 10 trong 10 điều luật của Thiếu Nhi Thánh Thể." },
      { id: 15, text: "Hãy viết nội quy 1 và 2 trong nội quy sa mạc của Thiếu Nhi Thánh Thể." },
      { id: 16, text: "Hãy viết nội quy 3 và 4 trong nội quy sa mạc của Thiếu Nhi Thánh Thể." },
      { id: 17, text: "Hãy viết nội quy 5 và 6 trong nội quy sa mạc của Thiếu Nhi Thánh Thể." },
      { id: 18, text: "Hãy viết nội quy 7 và 8 trong nội quy sa mạc của Thiếu Nhi Thánh Thể." },
      { id: 19, text: "Tên Liên đoàn Thiếu Nhi Thánh Thể tại Giáo phận Mỹ Tho là gì?" },
      { id: 20, text: "Hãy viết toàn bộ 10 điều luật của Thiếu Nhi Thánh Thể." },
      { id: 21, text: "Điền vào chỗ trống: Thiếu nhi Việt Nam đứng lên trong giai đoạn mới, theo tiếng Giáo Hội và tiếng quê hương kêu mời, _________ tuổi trẻ Việt Nam hăng hái xây thế hệ ngày mai." },
      { id: 22, text: "Điền vào chỗ trống: Cùng đi hỡi các Thiếu Nhi! Cùng đi với Chúa Kitô! Nguồn Sống Thánh Thể chan hòa, là _________ của người Thiếu Nhi hôm nay." },
      { id: 23, text: "Điền vào chỗ trống: Ngày nay con dâng cho Chúa, xin Chúa thương nhận lòng trí chúng con. Mọi cơn gian nan nguy khó, chúng con xin cầu theo ý _________ sớm hôm." },
      { id: 24, text: "Điền vào chỗ trống: Trời đã xế chiều, Giêsu ơi con nhờ tay Mẹ Maria, mà dâng lên Chúa, dâng chúc lời cám ơn, dâng trót cả _________." },
      { id: 25, text: "Điền vào chỗ trống: Nguyện xin, nguyện xin Chúa Cả mở tay chúc phúc, cho chúng con dùng, cho chúng con dùng nên _________ này." },
      { id: 26, text: "Điền vào chỗ trống: Đội ơn Chúa đời đời mạch sống, đã nuôi chúng con hồn xác hôm nay. Nguyện danh Chúa đời đời cả sáng, xuống cho mọi loài _________ no đầy." },
      { id: 27, text: "Điền vào chỗ trống: Như ánh hồng vươn lên khi hừng đông chiếu sáng. Như nguồn sống trào dâng khi mùa xuân về. Ta còn tiến bước vượt qua mọi gian khó. Ta cùng vươn lên tới _________ mong chờ." },
      { id: 28, text: "Điền vào chỗ trống: Nào bạn ơi mau lên gieo bước hành trình. Dòng thời gian đi nhanh chẳng biết dừng chân, đừng phân vân bi quan sẽ làm tất cả muộn màng cuộc sống quanh ta luôn _________." },
      { id: 29, text: "Điền vào chỗ trống: NÀO MAU LÊN ĐƯỜNG KHI TRỜI CÒN SÁNG BẠN ƠI. CÙNG NHAU BẮT ĐẦU ĐỂ CÙNG GẶT HÁI _________." },
      { id: 30, text: "Điền vào chỗ trống: Lửa Thiêng ơi hãy đến, bừng sáng lên trong đêm âm u soi đời tăm tối bao nhiêu _________." },
      { id: 31, text: "Điền vào chỗ trống: Ố ô ô ồ, ố ô ô ồ Cầm tay nhau quay vòng quanh lửa mới. Lửa bốc cháy tâm hồn ta hăng hái. Đón ánh lửa thiêng, đây đoàn ta, chung lời ca bên lửa _________." },
      { id: 32, text: "Điền vào chỗ trống: Màn đêm buông lơi theo ánh lửa dần tàn, tình anh em ta theo ánh lửa tràn lan, tim ta đây còn khắc ghi bao nhiêu mối tình _________." },
      { id: 33, text: "Điền vào chỗ trống: Lãnh nhận Lời Chúa em ơi xiết bao mừng vui. Lãnh nhận Lời Chúa em ơi gắng ghi trong lòng. Em nhớ rằng Thiên Chúa yêu em, Ngài yêu em không bờ bến, Ngài yêu em đến _________." },
      { id: 34, text: "Điền vào chỗ trống: Hiệp, Chiên, Ấu, Thiếu, Nghĩa, tuy năm ngành nhưng một. Với Anh Cả Giêsu em phụng thờ Thiên Chúa, là công dân em phụng sự quốc gia. Với ý hướng ngay lành, em là _________." },
      { id: 35, text: "Điền vào chỗ trống: Anh em ta về cùng nhau ta quây quần (nè). Một, hai, ba, bốn, năm. Anh em ta về cùng nhau ta xum họp (nè). Năm, bốn, ba, hai, một. Một - đều chân bước nhé! Hai - quay nhìn nhau đi! Ba - cầm tay chắc nhé. Không muốn ai chia lìa! Bốn - nhớ rằng: chúng ta bốn bể anh em một nhà! Năm - nhớ mãi tình này trong _________." }
    ];

    // Chọn ngẫu nhiên 15 câu hỏi
    const questions = allQuestions.sort(() => 0.5 - Math.random()).slice(0, 15);

    // Hiển thị câu hỏi và tạo input cho đáp án
    const questionContainer = document.getElementById('questions');
    questions.forEach((q, index) => {
      const div = document.createElement('div');
      div.className = 'question';
      div.innerHTML = `
        <p>${q.text}</p>
        <textarea id="answer${q.id}" name="answer${index + 1}" rows="4" placeholder="Nhập đáp án"></textarea>
        <input type="hidden" name="question${index + 1}" value="${q.text}">
      `;
      questionContainer.appendChild(div);
    });

    // Tạo options cho ngày/tháng/năm
    const dobDay = document.getElementById('dobDay');
    const dobMonth = document.getElementById('dobMonth');
    const dobYear = document.getElementById('dobYear');

    // Ngày: 1-31
    for (let i = 1; i <= 31; i++) {
      const option = document.createElement('option');
      option.value = i < 10 ? `0${i}` : i;
      option.textContent = i;
      dobDay.appendChild(option);
    }

    // Tháng: 1-12
    for (let i = 1; i <= 12; i++) {
      const option = document.createElement('option');
      option.value = i < 10 ? `0${i}` : i;
      option.textContent = i;
      dobMonth.appendChild(option);
    }

    // Năm: 2000-2025
    for (let i = 2025; i >= 2000; i--) {
      const option = document.createElement('option');
      option.value = i;
      option.textContent = i;
      dobYear.appendChild(option);
    }

    // Cập nhật thời gian nộp và user agent trước khi gửi
    const feedbackForm = document.getElementById('feedbackForm');
    feedbackForm.addEventListener('submit', function() {
      document.getElementById('submissionTime').value = new Date().toLocaleString('vi-VN', { timeZone: 'Asia/Ho_Chi_Minh' });
      document.getElementById('userAgent').value = navigator.userAgent;
    });

    // Hiển thị modal nội quy và kiểm tra thời gian truy cập
    const rulesModal = document.getElementById('rulesModal');
    const startExamButton = document.getElementById('startExam');
    const accessMessage = document.getElementById('accessMessage');
    const timerDisplay = document.getElementById('timer');
    const warningDisplay = document.getElementById('warning');
    const container = document.querySelector('.container');
    let timeLeft = 15 * 60; // 15 phút tính bằng giây
    let timerInterval;
    const examStartTime = new Date('2025-06-10T15:00:00+07:00').getTime();
    const examAccessEndTime = new Date('2025-06-10T20:00:00+07:00').getTime();

    function checkAccess() {
      const currentTime = new Date().getTime();
      if (currentTime < examStartTime) {
        rulesModal.style.display = 'flex';
        startExamButton.style.display = 'none';
        accessMessage.style.display = 'block';
        accessMessage.textContent = 'Bài kiểm tra sẽ bắt đầu vào 19:00 ngày 10/06/2025. Vui lòng quay lại sau!';
      } else if (currentTime >= examAccessEndTime) {
        rulesModal.style.display = 'flex';
        startExamButton.style.display = 'none';
        accessMessage.style.display = 'block';
        accessMessage.textContent = 'Thời gian truy cập bài kiểm tra đã kết thúc!';
        container.style.display = 'none';
      } else {
        rulesModal.style.display = 'flex';
        startExamButton.style.display = 'block';
        accessMessage.style.display = 'none';
      }
    }

    function startTimer() {
      timerDisplay.style.display = 'block';
      container.style.display = 'block';
      rulesModal.style.display = 'none';
      const startTime = new Date().getTime();
      const examEndTime = startTime + 15 * 60 * 1000; // 15 phút từ khi nhấn bắt đầu
      timeLeft = Math.floor((examEndTime - startTime) / 1000); // Tính lại timeLeft
      timerInterval = setInterval(() => updateTimer(examEndTime), 1000);
    }

    function updateTimer(examEndTime) {
      const currentTime = new Date().getTime();
      timeLeft = Math.floor((examEndTime - currentTime) / 1000);
      if (timeLeft <= 0 || currentTime >= examAccessEndTime) {
        clearInterval(timerInterval);
        timerDisplay.textContent = 'Hết giờ!';
        warningDisplay.style.display = 'none';
        container.style.display = 'none';
        rulesModal.style.display = 'flex';
        startExamButton.style.display = 'none';
        accessMessage.style.display = 'block';
        accessMessage.textContent = 'Thời gian làm bài đã kết thúc!';
        feedbackForm.submit();
        return;
      }

      const minutes = Math.floor(timeLeft / 60);
      const seconds = timeLeft % 60;
      timerDisplay.textContent = `Thời gian còn lại: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

      if (timeLeft <= 5 * 60) {
        warningDisplay.style.display = 'block';
      }
    }

    startExamButton.addEventListener('click', startTimer);

    // Kiểm tra truy cập ngay khi tải trang
    checkAccess();

    // Bảo mật: Cấm copy/paste
    document.addEventListener('copy', (e) => {
      e.preventDefault();
      alert('Hành vi sao chép bị cấm! Bài làm sẽ được nộp ngay lập tức.');
      feedbackForm.submit();
    });
    document.addEventListener('paste', (e) => {
      e.preventDefault();
      alert('Hành vi dán bị cấm! Bài làm sẽ được nộp ngay lập tức.');
      feedbackForm.submit();
    });
    document.addEventListener('cut', (e) => {
      e.preventDefault();
      alert('Hành vi cắt bị cấm! Bài làm sẽ được nộp ngay lập tức.');
      feedbackForm.submit();
    });

    // Bảo mật: Cấm chuyển tab
    let violationCount = 0;
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        violationCount++;
        if (violationCount >= 1) {
          alert('Cảnh báo: Chuyển tab/màn hình bị cấm! Bài làm sẽ được nộp ngay lập tức.');
          feedbackForm.submit();
        }
      }
    });
  </script>
</body>
</html>
